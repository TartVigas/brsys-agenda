<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>Nova reserva • Agenda BRsys</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="robots" content="noindex,nofollow" />
  <meta name="description" content="Criar nova reserva na Agenda BRsys." />
  <link rel="canonical" href="https://agenda.brsys.com.br/reserva-nova.html" />

  <link rel="icon" type="image/png" href="/img/favicon.png" />
  <link rel="apple-touch-icon" href="/img/favicon.png" />

  <link rel="stylesheet" href="/css/app.css" />
</head>

<body class="app-body">

  <!-- Topbar -->
  <header class="topbar">
    <div class="wrap topbar-inner">
      <div class="brand">
        <div class="brand-title">Agenda <span class="brand-accent">BRsys</span></div>
        <div class="brand-sub muted">Nova reserva • V1</div>
      </div>

      <div class="userbox">
        <div class="muted small">Logado:</div>
        <div id="userEmail" class="mono small">carregando…</div>
        <button id="logout" class="btn outline small" type="button">Sair</button>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="wrap main">

    <!-- Header / ações -->
    <section class="card">
      <div class="row" style="align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;">
        <div>
          <h1 class="h1" style="margin:0;">Nova reserva</h1>
          <p class="muted small" style="margin:6px 0 0 0;">
            Preencha o básico (nome, WhatsApp e datas). Depois evoluímos.
          </p>
        </div>

        <div class="row" style="gap:10px;flex-wrap:wrap;">
          <a class="btn outline" href="/reservas.html">Voltar</a>
          <a class="btn outline" href="/app.html">Home</a>
        </div>
      </div>

      <!-- FORM -->
      <form id="formReserva" autocomplete="off" style="margin-top:14px;">

        <!-- Nome -->
        <label class="label">
          Nome do hóspede
          <input
            class="input"
            type="text"
            id="nome"
            name="nome"
            required
            placeholder="Ex: João da Silva"
          />
        </label>

        <!-- WhatsApp -->
        <label class="label" style="margin-top:12px;">
          WhatsApp
          <input
            class="input"
            type="text"
            id="whatsapp"
            name="whatsapp"
            placeholder="(11) 99999-9999"
            inputmode="numeric"
            autocomplete="off"
          />
          <div class="muted small" style="margin-top:6px;">
            Dica: pode digitar com ou sem DDD. O sistema normaliza para WhatsApp.
          </div>
        </label>

        <!-- Quarto -->
        <label class="label" style="margin-top:12px;">
          Quarto
          <select id="quartoId" class="input">
            <option value="">(sem quarto)</option>
          </select>

          <div class="muted small" style="margin-top:6px;">
            Dica: cadastre e organize em <a class="muted" href="/quartos.html">Quartos</a>.
          </div>
        </label>

        <!-- Datas -->
        <div class="grid-2" style="margin-top:12px;">
          <label class="label">
            Check-in
            <input
              class="input"
              type="text"
              id="checkin"
              name="checkin"
              required
              placeholder="DD/MM/AAAA"
              inputmode="numeric"
              autocomplete="off"
            />
          </label>

          <label class="label">
            Check-out
            <input
              class="input"
              type="text"
              id="checkout"
              name="checkout"
              required
              placeholder="DD/MM/AAAA"
              inputmode="numeric"
              autocomplete="off"
            />
          </label>
        </div>

        <!-- Observações -->
        <label class="label" style="margin-top:12px;">
          Observações
          <textarea
            class="input"
            id="obs"
            name="obs"
            rows="3"
            placeholder="Ex: pagamento via Pix, cama extra, observações do hóspede…"
          ></textarea>
        </label>

        <!-- Mensagem -->
        <div id="msg" class="muted small" style="margin-top:10px;"></div>

        <!-- Ações -->
        <div class="row" style="margin-top:14px;gap:10px;flex-wrap:wrap;">
          <button id="btnSalvar" type="submit" class="btn primary">Salvar reserva</button>
          <button id="btnLimpar" type="button" class="btn outline">Limpar</button>
        </div>

        <!-- Atalhos rápidos -->
        <div class="row" style="margin-top:12px;gap:10px;flex-wrap:wrap;">
          <a class="btn outline small" href="/hoje.html">Ir para Hoje</a>
          <a class="btn outline small" href="/quartos.html">Gerenciar Quartos</a>
        </div>

      </form>
    </section>

    <footer class="foot muted small">
      BRsys Agenda • V1 • suporte via WhatsApp
    </footer>
  </main>

  <!-- Bottom Nav -->
  <nav class="bottom-nav">
    <a class="bn-item" data-nav="home" href="/app.html">Home</a>
    <a class="bn-item" data-nav="reservas" href="/reservas.html">Reservas</a>
    <a class="bn-item" data-nav="hoje" href="/hoje.html">Hoje</a>
    <a class="bn-item" data-nav="conta" href="/conta.html">Conta</a>
  </nav>

  <!-- Auth guard + email -->
  <script type="module">
    import { requireAuth } from "/js/auth.js";
    const user = await requireAuth({
      redirectTo: "/entrar.html?next=/reserva-nova.html",
      renderUserInfo: false
    });

    const el = document.getElementById("userEmail");
    if (el) el.textContent = user?.email || "(sem e-mail)";
  </script>

  <!-- Scripts -->
  <script type="module" src="/js/nav.js"></script>
  <script type="module" src="/js/reserva-nova.js"></script>

</body>
</html>
